(function(define) { 'use strict';
	var util = require("util");
	define(function(require, exports, module) {
		var fs = require("fs");
		(function() {
			/*var writeTextToFile = function(path, text) {
			    if(fs.existsSync(path)){
			        //已经存在，直接写入
			        fs.writeFileSync(path, text, 'utf-8');
			    }else{
			        var items = path.split('/');
			        var aPath = '.';
			        //目录不存在，那么创建之
			        for(var i=0; i<items.length - 1; i++){
			            aPath += '/' + items[i];
			            if(!fs.existsSync(aPath)){
			                fs.mkdirSync(aPath);
			            }
			        }
			        fs.writeFileSync(path, text, 'utf-8');
			    }
			                       
			}
			this.post = function(req, res) {
				var post = req.post;
				//console.log(post.files);
				writeTextToFile("E:\\workspace\\latte_web_server\\upload.jpg",post.files[0].content);
				res.end("1111");
			}*/
			
			/*this.get = function(req, res) {
				var get = req.get;
				res.end("get");
			}	*/
			this.post = function(req, res) {
				var post = req.post;
				//res.writeHead(200, {'content-type': 'text/plain'});
		        //res.end('received fields:\n\n '+util.inspect(post));
		        //console.log(post.files[0][1].path);
		        res.end(JSON.stringify({
		        	filePath: post.files[0][1].path,
		        	fileName: post.files[0][1].name
		        }));
			}
		}).call(module.exports);
	});
})(typeof define === 'function'  ? define : function (factory) { factory(require, exports, module); } );