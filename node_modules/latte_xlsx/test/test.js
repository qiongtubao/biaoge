var xlsx = require("../index");
var fs = require("fs");
var logger = {
	error: console.error,
	info: function( filename, data, callback) {
		if(!data){data = filename;filename = null;}
		if(typeof data == "function") { data("you wrong the method");}else if(typeof data != "string"){data = JSON.stringify(data);}
		if(!filename){console.log(data);}else{
			fs.writeFile(filename,data,{encoding:"utf8",mode:438,flag:"w"},function(err) {
				if(err){log.error(err);return;}
				//log.log(data);
				if(callback && typeof callback=="function"){callback();}
			});
		}
	}
};

(function test(){
	xlsx.read("./test",function(err, data){
	if(err){logger.error(err);return;}
		logger.info(data);
		//logger.info("test.json",data);
	});
})();

